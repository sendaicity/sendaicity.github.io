
var MierucaHM=function(){var b={local_url:window.location.href,referrer_url:document.referrer,sWs:("https:"===document.location.protocol?"wss":"ws")+"://ntjp.mieru-ca.com/hm",HM:{},site_id:window.__fid[0][0],temp_scroll_pos:0,window_width:0,idl:null,iwc:0,time_out:false,document_height:0,document_width:0,chkPrevEvent:null,temp_x_pos:0,temp_y_pos:0,read_check:"",lock_scroll_handle:0,scroll_read_top:0,window_height:0,href:"",text:"",ipa:0,device:(function(){var g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,e=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,d=/android|ipad|playbook|silk/i,f=navigator.userAgent||navigator.vendor||window.opera;if(g.test(f)||e.test(f.substr(0,4))){return"m"}if(d.test(f)){return"t"}return"d"}())},a=null,c=MierucaHM.prototype={initWindowElement:function(){var d=Math.floor(document.documentElement.scrollTop||document.body.scrollTop||0);b.document_height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);b.document_width=Math.max(document.body.scrollLeft,document.body.offsetWidth,document.documentElement.clientWidth,document.documentElement.scrollWidth,document.documentElement.offsetWidth);b.scroll_read_top=d;b.window_width=Math.floor(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth);b.window_height=Math.floor((window.innerHeight+d)>b.document_height?b.document_height:window.innerHeight)},sendPageView:function(){if("WebSocket" in window){a=new WebSocket(b.sWs)}else{if("MozWebSocket" in window){a=new MozWebSocket(b.sWs)}else{return}}c.initWindowElement();a.onopen=function(){(function(){var f=new Object();f.type="p";f.sId=b.site_id;f.url=b.local_url;f.refUrl=b.referrer_url;f.d=b.device;f.sP=b.window_height;f.dH=b.document_height;f.wW=b.window_width;f.wH=b.window_height;f.ipa="ipa";f.ua=navigator.userAgent||navigator.vendor||window.opera;a.sendMessage(JSON.stringify(f))})()};a.onclose=function(){b.iwc=1};a.sendMessage=function(f){if(f!==""&&b.iwc===0){if(a.readyState===a.OPEN){a.send(f)}}};var e=document.querySelectorAll("label,a,input,button,textarea,img,iframe,video"),d=0;for(d;d<e.length;d+=1){c.setEventClickListener(e[d])}window.onscroll=function(){if(b.time_out){return}if(b.lock_scroll_handle===0){c.scrollHandle()}c.readHandle();c.resetTimeOut()};c.resetTimeOut()},readHandle:function(){clearTimeout(b.read_check);b.read_check=setTimeout(function(){c.initWindowElement();if(b.scroll_read_top!==0){var d=new Object();d.type="r";d.rP=Math.floor(window.innerHeight+b.scroll_read_top)>=b.document_height?Math.floor(b.document_height-window.innerHeight):Math.floor(b.scroll_read_top);d.wW=Math.floor(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth);d.dH=b.document_height;d.wH=b.window_height;d.d=b.device;a.sendMessage(JSON.stringify(d))}},4000)},scrollHandle:function(){clearTimeout(b.sChk);b.sChk=setTimeout(function(){c.initWindowElement();var e=Math.floor(document.documentElement.scrollTop||document.body.scrollTop||0)+b.window_height;if(e>b.temp_scroll_pos){b.temp_scroll_pos=e;var d=new Object();d.type="s";d.sP=e>=b.document_height?b.document_height:e;d.dH=b.document_height;d.wW=b.window_width;d.wH=b.window_height;d.d=b.device;a.sendMessage(JSON.stringify(d));if(e>(b.document_height-200)){b.lock_scroll_handle=1}}},300)},resetTimeOut:function(){if(b.idl!==null){clearTimeout(b.idl)}b.idl=setTimeout(function(){b.time_out=true;b.idl=null},600000)},setEventClickListener:function(d){d.addEventListener("click",function(i){c.initWindowElement();if(!b.timeOut){i=i||window.event;var f=i.pageX!==undefined?Math.floor(i.pageX):0,h=i.pageY!==undefined?Math.floor(i.pageY):0;if(b.tempXp===f&&b.tempYp===h){if(this.nodeName!=="A"){return}clearTimeout(b.chkPrevEvent)}b.tempXp=f;b.tempYp=h;var g=new Object();g.txt=this.text===undefined?"":this.text;g.href=this.href===undefined?"":this.href;g.type="c";g.xP=f;g.yP=h;g.dW=b.document_width;g.dH=b.document_height;g.wW=b.window_width;g.d=b.device;b.chkPrevEvent=setTimeout(function(){a.sendMessage(JSON.stringify(g));b.chkPrevEvent=null},this.nodeName!=="A"?300:1)}})}};this.init=function(){c.sendPageView()}};(function(){window.__mieruca_heatmap=new MierucaHM();window.__mieruca_heatmap.init()}());